<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-color@3"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-interpolate@3"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-scale-chromatic@3"></script>
<svg id="my_dataviz" width="1900" height="700"></svg>
<script>

    // The svg
    const svg = d3.select("svg"),
        width = +svg.attr("width"),
        height = +svg.attr("height");

    // Map and projection
    const path = d3.geoPath();
    const projection = d3.geoMercator()
        .scale(70)
        .center([0,20])
        .translate([width / 2, height / 2]);

    // Data and color scale
    let data = new Map()
    const colorScale = d3.scaleThreshold()
        .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
        .range(d3.schemeBlues[7]);

    d3.queue()
        .defer(d3.json, "data/UK_LA_map.geojson")
        .defer(d3.csv, "data/ltla_2022-04-22.csv", function(d) {
                    data.set(d.areaCode, +d.newPeopleVaccinatedFirstDoseByVaccinationDate);
                })
        .await(ready);

    function ready(error, geojson) {

        // Draw the map
        svg.append("g")
            .selectAll("path")
            .data(geojson.features)
            .enter()
            .append("path")
            // draw each country
            .attr("d", path.projection(projection)
            )
            // set the color of each country
            .attr("fill", function (d) {
                d.total = data.get(d.lad20cd) || 0;
                return colorScale(d.total);
            });
    }

</script>
</html>